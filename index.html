<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>신 의 손 v20.0 - 슬림</title>
    <style>
        :root { --gold: #ffd700; --bg: #0b0b0b; --card: #1a1a1a; --accent: #00ffcc; --save: #ff00ff; }
        body { background-color: var(--bg); color: var(--gold); font-family: 'Malgun Gothic', sans-serif; padding: 10px; margin: 0; }
        .outer-border { border: 2px solid var(--gold); border-radius: 20px; padding: 15px; max-width: 480px; margin: 0 auto; }
        
        /* 상단 슬림 헤더 */
        .header-box { text-align: center; margin-bottom: 10px; display: flex; justify-content: center; align-items: center; gap: 10px; }
        .next-episode { font-size: 24px; font-weight: 900; color: #fff; }

        /* 번호 선택기 (접이식) */
        .selector-container { margin-bottom: 15px; }
        .selector-toggle { width: 100%; height: 40px; background: #222; border: 1px solid var(--gold); border-radius: 10px; color: var(--gold); font-weight: bold; cursor: pointer; margin-bottom: 5px; display: flex; justify-content: center; align-items: center; gap: 10px; }
        .selector-toggle::after { content: '▼'; font-size: 10px; }
        .selector-toggle.open::after { content: '▲'; }
        
        #selectorPanel { display: none; background: #1a1a1a; border-radius: 10px; padding: 10px; border: 1px solid #333; margin-bottom: 10px; }
        .selector-grid { display: grid; grid-template-columns: repeat(9, 1fr); gap: 4px; }
        .sel-box { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; font-size: 12px; border-radius: 4px; background: #333; color: #888; cursor: pointer; }
        .sel-box.active { background: var(--accent); color: #000; font-weight: bold; }
        
        /* 메인 버튼 그룹 */
        .btn-group { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 15px; }
        button { border-radius: 10px; font-weight: bold; cursor: pointer; border: none; }
        .btn-main { height: 50px; background: linear-gradient(to bottom, #ffd700, #b8860b); color: #000; font-size: 16px; }
        .btn-sub { height: 45px; background: #222; color: #fff; border: 1px solid #444; }

        /* 결과창 */
        .row-line { background: var(--card); border-radius: 12px; padding: 10px; margin-bottom: 8px; display: flex; align-items: center; justify-content: space-between; border: 1px solid #333; }
        .num-container { display: flex; gap: 4px; flex-grow: 1; justify-content: center; }
        .num-box { width: 32px; height: 32px; line-height: 32px; text-align: center; font-size: 14px; font-weight: 900; border-radius: 50%; color: #fff; }
        .fixed { background: #00ffcc; color: #000; } 
        .missing { background: #ff4444; } 
        .normal { background: #444; border: 1px solid var(--gold); }
        .save-btn { font-size: 11px; background: var(--save); color: white; padding: 4px 8px; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body onload="initApp()">
<div class="outer-border">
    <div class="header-box">
        <span class="next-episode">1212회 분석기</span>
        <span id="selCount" style="font-size:12px; color:var(--accent);">[15수 설정됨]</span>
    </div>

    <div class="selector-container">
        <button id="toggleBtn" class="selector-toggle" onclick="togglePanel()">분석 번호 수정하기</button>
        <div id="selectorPanel">
            <div class="selector-grid" id="selectorGrid"></div>
            <button onclick="saveMyPool()" style="width:100%; margin-top:10px; height:35px; background:var(--accent); color:#000; border-radius:5px; font-weight:bold;">번호 저장 및 닫기</button>
        </div>
    </div>

    <div class="btn-group">
        <button class="btn-main" onclick="processSmart(5)">5조합 뽑기</button>
        <button class="btn-main" onclick="processSmart(10)">10조합 뽑기</button>
        <button class="btn-sub" onclick="toggleStorage()">보관함</button>
        <button class="btn-sub" onclick="resetAll()">지우기</button>
    </div>

    <div id="console"></div>
    <div id="storage-section" style="display:none; margin-top:10px; border-top:1px dashed #444; padding-top:10px;">
        <div id="storage"></div>
    </div>
</div>

<script>
    const ALL_DRAWS = [[23,26,27,35,38,40],[1,7,9,17,27,38],[2,17,20,35,37,39],[6,27,30,36,38,42],[10,22,24,27,38,45],[1,3,17,26,27,42],[1,4,16,23,31,41],[8,16,28,30,31,44],[3,6,18,29,35,39],[5,12,21,33,37,40],[7,9,24,27,35,36],[1,2,4,16,20,32],[16,24,25,30,31,32],[26,30,33,38,39,41],[1,5,7,26,28,43],[8,12,15,29,40,45],[3,15,27,33,34,36],[3,13,15,24,33,37],[6,9,16,19,24,28],[10,16,23,36,39,40],[1,4,11,12,20,41],[7,9,19,23,26,45]];
    
    let myPool = JSON.parse(localStorage.getItem('myPoolV20')) || [1,3,7,15,16,17,23,24,26,27,31,33,38,39,42];
    let savedNumbers = JSON.parse(localStorage.getItem('lottoSaveV20')) || [];

    function initApp() {
        renderSelector();
        document.getElementById('console').innerHTML = localStorage.getItem('lastConsoleV20') || "";
        updateCount();
    }

    function togglePanel() {
        const panel = document.getElementById('selectorPanel');
        const btn = document.getElementById('toggleBtn');
        if(panel.style.display === 'block') {
            panel.style.display = 'none';
            btn.classList.remove('open');
        } else {
            panel.style.display = 'block';
            btn.classList.add('open');
        }
    }

    function renderSelector() {
        const grid = document.getElementById('selectorGrid');
        grid.innerHTML = "";
        for(let i=1; i<=45; i++) {
            const div = document.createElement('div');
            div.className = `sel-box ${myPool.includes(i) ? 'active' : ''}`;
            div.innerText = i;
            div.onclick = () => {
                if(myPool.includes(i)) myPool = myPool.filter(n => n !== i);
                else if(myPool.length < 25) myPool.push(i);
                div.className = `sel-box ${myPool.includes(i) ? 'active' : ''}`;
                updateCount();
            };
            grid.appendChild(div);
        }
    }

    function updateCount() {
        document.getElementById('selCount').innerText = `[${myPool.length}수 설정됨]`;
    }

    function saveMyPool() {
        localStorage.setItem('myPoolV20', JSON.stringify(myPool));
        togglePanel();
        alert("수정된 번호가 저장되었습니다.");
    }

    function resetAll() {
        document.getElementById('console').innerHTML = "";
        localStorage.removeItem('lastConsoleV20');
    }

    function processSmart(limit) {
        if(myPool.length < 6) return alert("분석 번호를 6개 이상 골라주세요.");
        const box = document.getElementById('console');
        box.innerHTML = "";
        
        for(let i=0; i<limit; i++) {
            let res = [...myPool].sort(() => Math.random() - 0.5).slice(0, 6).sort((a,b)=>a-b);
            const html = res.map(n => `<span class="num-box normal">${n}</span>`).join('');
            box.innerHTML += `<div class="row-line"><div class="num-container">${html}</div><div class="save-btn" onclick="saveToBox('${res.join(',')}')">저장</div></div>`;
        }
        localStorage.setItem('lastConsoleV20', box.innerHTML);
    }

    function saveToBox(s) {
        if(!savedNumbers.includes(s)) {
            savedNumbers.push(s);
            localStorage.setItem('lottoSaveV20', JSON.stringify(savedNumbers));
            alert("저장완료");
        }
    }

    function toggleStorage() {
        const s = document.getElementById('storage-section');
        s.style.display = s.style.display === 'none' ? 'block' : 'none';
        const st = document.getElementById('storage');
        st.innerHTML = savedNumbers.map(n => `<div class="row-line"><div class="num-container">${n.split(',').map(v=>`<span class="num-box normal" style="background:#555;">${v}</span>`).join('')}</div></div>`).join('');
    }
</script>
</body>
</html>
